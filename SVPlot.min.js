class t{static context;constructor(e,s={},i=!1){t.context=this,this.$root=t.make(e,s,i)}static make(e,s={},i=!1){return e&&"object"==typeof s?s instanceof Node?s:("svg"==e&&(i=!0),t.config(i?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e),s,i)):null}static makeIn(e,s,i={},l=!1){return i.context=e,t.make(s,i,l)}static config(e,s,i=!1){if(Array.isArray(e))return e.forEach(e=>t.config(e,s,i)),null;if(!(e instanceof Node)||"object"!=typeof s)return e;let l=s.context;t.context=null===l?null:l||t.context,l=t.context;let a=s=>{if(s)if(s instanceof Node)e.appendChild(s);else if(s instanceof t)e.appendChild(s.$root);else if("string"==typeof s)e.innerHTML+=s;else if("object"==typeof s){let l=t.make(s.tag??"div",s,i||"svg"==s.tag);l&&e.appendChild(l)}};for(const[i,r]of Object.entries(s)){switch(i){case"text":e.textContent=null==r?"":r+"";continue;case"html":e.innerHTML=null==r?"":r+"";continue;case"tag":case"context":case"get":case"also":continue}if(r)switch(i){case"class":(Array.isArray(r)?r:r.split(" ")).map(t=>t&&e.classList.add(t));break;case"push":r.push(e);break;case"$":case"var":l&&(l["$"+r]=e);break;case"events":for(let t in r)e.addEventListener(t,l?r[t].bind(l):r[t]);break;case"click":case"change":case"input":case"mousewheel":e.addEventListener(i,l?r.bind(l):r);break;case"parent":r.appendChild(e);break;case"attrs":for(let t in r)e.setAttribute(t,r[t]);break;case"props":for(let t in r)e[t]=r[t];break;case"child_r":t.clear(e);case"child":a(r);break;case"children_r":t.clear(e);case"children":for(let t of r)a(t);break;case"style_r":e.style.cssText="";case"style":if("string"==typeof r)e.style.cssText+=r+";";else for(let t in r)r[t]&&(e.style[t]=r[t]);break;default:e[i]=r}}return s.also&&l&&s.also.call(l,e),e}static configIn(e,s,i,l=!1){return i.context=e,t.config(s,i,l)}static clear(t){for(;t.firstChild;)t.removeChild(t.lastChild)}static makeArray(e,s=!1){return e&&Array.isArray(e)?e.map(e=>t.make(e.tag,e,s)):[]}static makeShadow(e,s={},i=null){if(!e||"object"!=typeof s)return null;let l=e instanceof Node?e:document.createElement(e);return l.attachShadow({mode:"open"}),t.config(l.shadowRoot,{context:s.context,children:[{tag:"style",textContent:i??""},s.child??{},...s.children??[]]}),delete s.children,delete s.child,t.config(l,s),l}}class e{static make=(e,s)=>t.make(e,s,!0);static config=(e,s)=>t.config(e,s,!0);static makeArray=e=>t.makeArray(e,!0);static svg=(t={},s={})=>e._make("svg",t,s);static rect=(t,s,i,l,a,r,o={},n={})=>e._make("rect",{...o,x:t,y:s,width:i,height:l,rx:a,ry:r},n);static circle=(t,s,i,l={},a={})=>e._make("circle",{...l,cx:t,cy:s,r:i},a);static line=(t,s,i,l,a={},r={})=>e._make("line",{...a,x1:t,y1:s,x2:i,y2:l},r);static polyline=(t,s={},i={})=>e._make("polyline",{...s,points:t},i);static polygon=(t,s={},i={})=>e._make("polygon",{...s,points:t},i);static path=(t,s={},i={})=>e._make("path",{...s,d:t},i);static text=(t,s,i,l={},a={})=>e._make("text",{...l,x:s,y:i},{...a,text:t});static _make=(t,s={},i={})=>e.make(t,{attrs:{...s},...i})}new Set,new Map;const s=(t,e,s)=>t<e?e:t>s?s:t,i=(t,e=1)=>t[t.length-e],l=()=>(new Date).getTime(),a=()=>new Promise(t=>requestAnimationFrame(()=>setTimeout(t,0))),r=t=>{if(!Array.isArray(t))return t.clientWidth||t.clientHeight;for(let e of t)if(!r(e))return 0;return 1},o=15,n=12;class c{data={};cfg={dark:!1,type:"plot",labels:[],period:200};sel_mode=!1;pressX=0;constructor(i,l={},h=window){c.css=function(t){if(t){let e=document.createElement("style");e.innerText=t,document.head.appendChild(e)}return null}(c.css),i.style.overflow="hidden",t.makeIn(this,"div",{parent:i,class:"svp",$:"svp",children:[{class:"menu",children:[{class:"labels",$:"labels"},{style:"display:flex",children:[{class:"buttons none",$:"buttons",children:[{class:"button",child:f("M 2,12 H 22 M 2,12 6.2,16.2 M 2,12 6.2,7.7 M 22,12 17.7,7.7 M 22,12 17.7,16.2"),click:()=>this.fitData()},{class:"button",$:"single",child:f("M17 4V20M17 20L13 16M17 20L21 16M7 20V4M7 4L3 8M7 4L11 8"),click:()=>{this.$single.classList.toggle("active"),this._render()}},{class:"button",text:"1s",click:()=>this._setMax(1)},{class:"button",text:"1m",click:()=>this._setMax(60)},{class:"button",text:"1h",click:()=>this._setMax(3600)},{class:"button",text:"1d",click:()=>this._setMax(86400)},{class:"button",text:"1w",click:()=>this._setMax(604800)},{class:["sel_mode","button"],$:"sel_mode",child:f("M4.4 3.4c-.5-.1-.7-.2-.84-.14a.5.5 0 0 0-.3.3c-.1.16.0.4.14.84l4.21 14.3c.13.4.2.64.3.7a.5.5 0 0 0 .4.1c.16-.03.3-.2.6-.5L12 16l4.4 4.4.2.2.3.3.4.3a.5.5 0 0 0 .31 0c.1-.0.2-.14.41-.3l2.9-2.9c.2-.2.3-.3.3-.41a.5.5 0 0 0 0-.31c-.1-.1-.1-.2-.3-.41L16 12l3.1-3.1c.3-.3.47-.47.5-.63a.5.5 0 0 0-.1-.4c-.1-.13-.3-.2-.74-.31l-14.3-4.2Z"),click:()=>{this.sel_mode=!this.sel_mode,this.$sel_mode.classList.toggle("active")}},{class:"button",child:f("M3 21L21 3M3 21H9M3 21L3 15M21 3H15M21 3V9"),$:"fullscr",click:()=>{this.$svp.classList.toggle("fullscreen"),this.$fullscr.classList.toggle("active")}},{class:"button",child:f("M21 21H3M18 11L12 17M12 17L6 11M12 17V3"),click:()=>function(t){t.style.width=t.clientWidth+"px",t.style.height=t.clientHeight+"px";let e=new XMLSerializer,s=document.createElement("a");s.href="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e.serializeToString(t)),s.download="plot.svg",s.click(),t.style.width="100%",t.style.height="100%"}(this.$plot)},{class:"button",child:f("M18 6L6 18M6 6L18 18"),click:()=>this.clearData()},{class:"button",child:f("M4 12H20M20 12L14 6M20 12L14 18"),$:"auto",click:()=>this.autoData()}]}]},{class:"dots",child:{tag:"svg",$:"dots",style:"width: 4px;height: 18px",children:[...Array(3).keys()].map(t=>({tag:"circle",attrs:{cx:2,cy:2+7*t,r:2,fill:"var(--font)"}}))},click:()=>{this.$buttons.classList.toggle("none"),this.$labels.classList.toggle("none")}}]},{class:"svcont",$:"svcont",child:{tag:"svg",$:"plot",class:"svg",style:"font-family: Verdana, sans-serif;pointer-events: none;",attrs:{width:"100%",height:"100%"},children:[{tag:"g",$:"grid"},{tag:"g",$:"cursor"},{tag:"g",$:"lines"},{tag:"g",$:"markers"},{tag:"g",$:"gtext"},{tag:"g",$:"dur",children:[{tag:"rect",$:"dur_rect",attrs:{y:15,width:0,stroke:"none",fill:"black"},style:"filter: opacity(0.3)"},{tag:"text",$:"dur_text",attrs:{y:11,fill:"--font","text-anchor":"middle"},style:"font-size: 13px"}]},{tag:"g",$:"tooltip",style:"filter: opacity(0.9)"}]}}]}),function(t,e,s=window,i=300,l=5){let a=(...t)=>s.document.addEventListener(...t),r=(...t)=>s.document.removeEventListener(...t);const o="ontouchstart"in s.document.documentElement;let n=0,c=[],h=null,d={x:0,y:0},p={x:0,y:0},f=!1,g=(s,i)=>{e({type:s,touch:o,width:t.clientWidth,height:t.clientHeight,move:{x:0,y:0},pos:{x:0,y:0},drag:d,pressed:o?c.length>=2:n,...i})},u=(e,i)=>({x:Math.round(e-t.getBoundingClientRect().left),y:Math.round(i-t.getBoundingClientRect().top-s.document.documentElement.scrollTop)}),m=t=>u(t.pageX,t.pageY),x=()=>{d={x:0,y:0},p={x:0,y:0},h&&clearTimeout(h),h=setTimeout(()=>h=null,i)},y=()=>{h&&(clearTimeout(h),h=null)},b=()=>{let t=0;return h&&(y(),t=Math.abs(d.x)<l&&Math.abs(d.y)<l),d={x:0,y:0},p={x:0,y:0},t};if(o){let e=(t,e)=>{for(let i in t.changedTouches)if(t.changedTouches[i].identifier==e)return s(t,i);return null},s=(t,e)=>{let s=t.changedTouches[e];return{id:s.identifier,x:s.pageX,y:s.pageY}},i=e=>{f&&e.target!=t&&!c.length&&(f=!1,g("leave"),r("touchstart",i),r("touchmove",l),r("touchend",o),r("touchcancel ",o))},l=t=>{if(c.length){if(1==c.length){let s=c[0],i=e(t,s.id);if(!i)return;t.preventDefault();let l=i.x-s.x,a=i.y-s.y;p.x+=l,p.y+=a,g("move",{move:{x:l,y:a},pos:u(i.x,i.y)}),g("tdrag",{move:{x:l,y:a},drag:p,pos:u(i.x,i.y)}),y()}else{let s=[0,0],i=[0,0],l=0;for(let a in s)i[a]=c[a],s[a]=e(t,i[a].id),s[a]?l=1:s[a]=i[a];if(l){t.preventDefault();let e=(s[0].x+s[1].x)/2,l=(s[0].y+s[1].y)/2,a=e-(i[0].x+i[1].x)/2,r=l-(i[0].y+i[1].y)/2;d.x+=a,d.y+=r,g("drag",{move:{x:a,y:r},pos:u(e,l)});let o=Math.abs(s[0].x-s[1].x),n=Math.abs(s[0].y-s[1].y),c=Math.abs(i[0].x-i[1].x),h=Math.abs(i[0].y-i[1].y);g("zoom",{zoom:Math.hypot(o,n)-Math.hypot(c,h),pos:u(e,l)})}}for(let s in c){let i=e(t,c[s].id);i&&(c[s]=i)}}},o=t=>{if(c.length){let e=s(t,0);if(!e)return;let i=c.findIndex(t=>e.id==t.id);~i&&(t.preventDefault(),c.splice(i,1),c.length||(g("trelease",{pos:u(e.x,e.y)}),b()&&g("click",{pos:u(e.x,e.y)})),1==c.length&&g("release",{pos:u(e.x,e.y)}))}};t.addEventListener("touchstart",t=>{t.preventDefault();let e=s(t,0);if(!e)return;let r=c.findIndex(t=>e.id==t.id);~r&&c.splice(r,1),c.unshift(e),1==c.length&&(x(),f||(f=!0,a("touchstart",i,{passive:!1}),a("touchmove",l,{passive:!1}),a("touchend",o),a("touchcancel ",o),g("enter",{pos:u(e.x,e.y)})),g("tpress",{pos:u(e.x,e.y)})),2==c.length&&(g("press",{pos:u(e.x,e.y)}),y())},{passive:!1})}else{let e=()=>{r("mousemove",i),r("mouseup",l)},s=()=>{a("mousemove",i),a("mouseup",l)},i=t=>{n&&(t.preventDefault(),d.x+=t.movementX,d.y+=t.movementY,g("drag",{move:{x:t.movementX,y:t.movementY},pos:m(t)}))},l=s=>{n&&(s.preventDefault(),n=0,g("release",{pos:m(s)}),b()&&g("click",{pos:m(s)}),s.target!==t&&e())};t.addEventListener("mouseenter",t=>{g("enter",{pos:m(t)}),s()}),t.addEventListener("mouseleave",t=>{g("leave",{pos:m(t)}),n||e()}),t.addEventListener("mousedown",t=>{n||(s(),t.preventDefault(),n=1,x(),g("press",{pos:m(t)}))}),t.addEventListener("mousemove",t=>{n||g("move",{move:{x:t.movementX,y:t.movementY},pos:m(t)})}),t.addEventListener("wheel",t=>{t.preventDefault(),g("zoom",{zoom:-t.deltaY/100,pos:m(t)})},{passive:!1})}}(this.$svcont,t=>{let i=this.$plot.clientWidth,l=this.$plot.clientHeight;if(!i||!l)return;let a="timeline"==this.cfg.type;t.touch&&"move"===t.type&&(t.type="drag");let r=this._isUnix(),c=t=>(t/1e6).toFixed(3);switch(t.type){case"zoom":{let e=()=>this.maxSecs=s(this.maxSecs,1,31536e4),l=this.maxSecs;t.touch?(this.maxSecs-=t.zoom/(i/this.maxSecs/2),e(),this.tZero+=(this.maxSecs-l)/2):(this.maxSecs*=-t.zoom/5+1,e(),this.tZero+=(this.maxSecs-l)*(1-t.pos.x/i)),this.auto&&this._resetZ(),this._clearMarkers(),this._render()}break;case"drag":if(this.sel_mode){let s=Math.abs(t.pos.x-this.pressX),l=Math.min(this.pressX,t.pos.x),a=s/i*this.maxSecs,o=r?Math.floor(a/86400)+":"+new Date(1e3*a).toISOString().slice(11,22):c(1e3*a);e.config(this.$dur_rect,{attrs:{x:Math.min(this.pressX,t.pos.x),width:s}}),e.config(this.$dur_text,{attrs:{x:l+s/2,fill:this._getProp("--font")},text:o})}else this.tZero-=t.move.x/(i/this.maxSecs),this._auto(!1),this._render();break;case"press":case"tpress":this._clearMarkers(),this.pressX=t.pos.x,this.sel_mode&&(e.config(this.$dur_rect,{attrs:{x:t.pos.x,width:0,height:l-o-16}}),this.$dur.style.display="unset");break;case"release":case"trelease":this.$dur.style.display="none";break;case"leave":this._clearMarkers();break;case"move":case"click":{let h,f,g=1e3*(this.tZero-(1-t.pos.x/i)*this.maxSecs),u=t=>(t=>new Date(t-6e4*(new Date).getTimezoneOffset()))(t).toISOString().split("T"),m=r?u(g).join(" ").slice(0,-3):c(g);e.config(this.$cursor,{children_r:[p(t.pos.x,a?0:16,t.pos.x,l-o,this._getProp("--grid"),1),h=e.rect(0,l-o,0,o,3,0,{fill:this._getProp("--grid")}),f=d(m,t.pos.x,l-3,this._getProp("--font"),12,{"text-anchor":"middle"})]});let x=f.getBBox();e.config(f,{attrs:{x:s(x.x+x.width/2,x.width/2,i-x.width/2)}});const y=4;if(x=f.getBBox(),e.config(h,{attrs:{width:x.width+2*y,x:x.x-y}}),!this.points)break;let b=t=>{let s=e.make("rect");e.config(this.$tooltip,{children_r:[s,...t]});let l=this.$tooltip.getBBox();e.config(s,{attrs:{x:l.x-4,width:l.width+8,y:l.y-4,height:l.height+8,rx:4,fill:this._getProp("--back"),stroke:this._getProp("--font")}}),e.config(this.$tooltip,{attrs:{transform:`translate(${i-1-l.width-4} 18)`}})},k=this._getProp("--font");if(a){if("click"==t.type){for(let t of this.points)t.rect.classList.remove("active");for(let e of this.points)if(t.pos.x>=e.x1&&t.pos.x<=e.x2&&t.pos.y>=e.y1&&t.pos.y<=e.y2){let t=-16,s=t=>r?u(t).join(" ").slice(0,-5):c(t),i=r?new Date(e.block.stop-e.block.start).toISOString().substring(11,19):c(e.block.stop-e.block.start);b([d(this.cfg.labels[e.axis],0,t+=16,this._getCol(e.axis),n,{},!0),d("Start: "+(e.block.fstart?"-":s(e.block.start)),0,t+=19,k,n),d("Stop: "+(e.block.fstop?"-":s(e.block.stop)),0,t+=16,k,n),d("Duration: "+i,0,t+=16,k,n)]),e.rect.classList.add("active");break}}}else{let t=0,s=Object.keys(this.points).map(Number);for(let e=1;e<s.length;e++)if(s[e]>=g){t=s[s[e]-g<g-s[e-1]?e:e-1];break}if(t&&this.points[t].y){e.config(this.$markers,{children_r:this.points[t].y.map((s,i)=>this._disabled(i)?null:e.circle(this.points[t].x,s,4,{stroke:this._getCol(i),fill:this._getProp("--back"),"stroke-width":2}))});let s=-16;b([...this.points[t].y.map((e,i)=>d(`${this.cfg.labels[i]??i}: ${this.data[t][i].toFixed(2)}${this.units[i]??""}`,0,s+=16,this._getCol(i),n,{},!0)),d(r?u(t)[0]:(t/1e6).toFixed(3),0,s+=21,k,n),r?d(u(t)[1].slice(0,-2),0,s+=16,k,n):null])}}}}},h),this.setConfig(l),this._resizer=new ResizeObserver(()=>a().then(()=>this._render())),this._resizer.observe(this.$plot),async function(t,e=null,s=10){for(;!r(t)&&--s;)await a();s||(t=null),e&&e(t)}(this.$plot,()=>{this.maxSecs=this.$plot.clientWidth/10,this.maxSecs<30&&(this.maxSecs=30)})}release(){this._resizer.disconnect()}setConfig(e){this.cfg={...this.cfg,...e},this.$svp.className="svp "+(this.cfg.dark?"dark":"light"),this.$plot.style.background=this._getProp("--back"),this.units=[],this.dashed=[],this.cfg.labels=this.cfg.labels.map(t=>{let e="",s=t.match(/(.*)\[(.*)\]$/);s&&(t=s[1],e=s[2]),this.units.push(e);let i=0;for(;t.startsWith("-");)t=t.slice(1),++i;return this.dashed.push(i),t}),this.labels=[],t.config(this.$labels,{children_r:this.cfg.labels.map((e,s)=>t.make("div",{class:"label",push:this.labels,children:[{class:"marker",style:`background:${this._getCol(s)}`},{tag:"span",text:e}],click:()=>{"timeline"!=this.cfg.type&&(this.labels[s].classList.toggle("tint"),this._render())}}))}),this.tmr&&clearTimeout(this.tmr),this._render()}setLabels(t){this.setConfig({labels:t})}clearData(){this.data={},this.tZero=l()/1e3|0,this._render()}fitData(){this._resetZ(),this._fit(),this._render()}autoData(){this._resetZ(),this._auto(!0),this._render()}setRange(t){this.maxSecs=this._isUnix()?t:1e3*t}setData(t){let e=Array.isArray(t),s=t=>t.map(t=>{let e=Number(t);return Number.isNaN(e)?0:e});switch(this.cfg.type){case"running":this.tmr&&clearTimeout(this.tmr),this.tmr=setTimeout(()=>{let t=Object.values(this.data);var e,s;t.length<2||(e=i(t),s=i(t,2),e&&s&&e.every((t,e)=>t===s[e])&&delete this.data[i(Object.keys(this.data))],this.setData([...i(t)]))},this.cfg.period);case"stack":if(!e)return;this.data[l()]=s(t);break;case"timeline":if(e)return;if(!Array.isArray(Object.values(t)[0])){let e={};for(let s in t)for(let i in t[s])e[i]=!0;let s=new Array(Object.keys(e).length).fill(!1),l=Object.values(this.data);l.length&&(s=[...i(l)]);for(let e in t){for(let i in t[e])s[i]=t[e][i];t[e]=[...s]}}default:if(e)return;let a=Number(i(Object.keys(this.data)));for(let e in t){let i=Number(e);i=Math.floor(i<99999999999?1e3*i:i),(!a||a<i)&&(this.data[i]=s(t[e]))}}if(!this.cfg.labels.length){let t=Object.values(this.data);t.length&&this.setConfig({labels:t[0].map((t,e)=>"Line "+e)})}this.tZero||(this._auto(!0),this._fit()),this.auto&&(this._resetZ(),this._clearMarkers()),this._render()}_render(){if(t.clear(this.$lines),t.clear(this.$grid),t.clear(this.$gtext),this.points=null,!this.tZero)return;let s=this.$plot.clientWidth,l=this.$plot.clientHeight;if(l<50)return;let a=Object.keys(this.data).map(Number),r=(t,e,s)=>((t,e,s,i)=>s==e?i:(t-e)*(16-i)/(s-e)+i)(t,e,s,l-o),n=t=>s+(t/1e3-this.tZero)*s/this.maxSecs,c=t=>this.points[a[t]]=this.data[a[t]];for(let t=0;t<a.length;t++)if(this.points){if(c(t),a[t]>=1e3*this.tZero)break}else t+1<a.length&&a[t+1]>=1e3*(this.tZero-this.maxSecs)&&(this.points={},c(t));if(this.points)if("timeline"==this.cfg.type){let t=Object.values(this.points),s=Object.keys(this.points).map(Number),a=[];for(let e in t[0]){let l=[],r=0;t[0][e]&&(l.push({fstart:!0,start:s[0]}),r=1);for(let t in this.points){t=Number(t);let s=this.points[t][e];r&&!s&&(i(l).stop=t,r=0),!r&&s&&(l.push({start:t}),r=1)}if(r){let t=i(l);t.stop=i(s),t.fstop=!0}a.push(l)}let r=t[0].length,c=(l-o-5)/r,d=.8*c;this.points=[];for(let t in a){t=Number(t);for(let s of a[t]){let i=n(s.start),l=n(s.stop),a=c*t+(c-d)/2,r=e.rect(i,a,l-i,d,3,0,{fill:this._getCol(t)},{class:"tblock"});this.$lines.appendChild(r),r.style.setProperty("--active",h(t,1,this._getColv()+.1)),this.points.push({x1:i,x2:l,y1:a,y2:a+d,axis:t,block:s,rect:r})}}}else{let t=Object.keys(this.points).length,i=s/1;if(t>i){let e=this.points;this.points={};let s=Object.keys(e);for(let l=0;l<i;l++){let a=Math.floor(l/i*t);this.points[s[a]]=e[s[a]]}}const a=999999999;let o=-a,c=a,h={},f={};for(let t in this.points){let e=this.points[t];for(let t in e)this._disabled(t)||(e[t]>o&&(o=e[t]),e[t]<c&&(c=e[t]),t in h||(h[t]=-a),t in f||(f[t]=a),e[t]>h[t]&&(h[t]=e[t]),e[t]<f[t]&&(f[t]=e[t]))}if(c!=a){let t=this.$single.classList.contains("active");for(let e in this.points){let s,i=n(e);s=t?this.points[e].map((t,e)=>r(t,f[e],h[e])):this.points[e].map(t=>r(t,c,o)),this.points[e]={x:i,y:s}}let i=Object.values(this.points);for(let t in i[0].y){if(this._disabled(t))continue;let s="";i.forEach(e=>s+=`${e.x},${e.y[t]} `);let l=this.dashed[t];e.config(this.$lines,{child:e.polyline(s,{fill:"none",stroke:this._getCol(t),"stroke-width":l?1.5:2,"stroke-dasharray":`${3*l} ${2*l}`})})}{const e=9;let i=Math.round(l/80),a=(o-c)/i,n={filter:`drop-shadow(0 0 1px ${this._getProp("--back")})`};for(let e=0;e<i+1;e++){let l=r(o-a*e,c,o);e!=i&&this.$grid.appendChild(p(0,l,s,l,this._getProp("--grid"),1,{"stroke-dasharray":"7 8"})),t||this.$gtext.appendChild(d((o-a*e).toFixed(1),0,l-5,this._getProp("--font"),12,n))}if(t){let t=0;for(let s in h){s=Number(s);for(let e=0;e<i+1;e++){let l=r(o-a*e,c,o);this.$gtext.appendChild(d((h[s]-(h[s]-f[s])/i*e).toFixed(1),t,l-5,this._getCol(s),12,n))}t+=Math.max(h[s].toFixed(1).length,f[s].toFixed(1).length)*e}}}}}{let t=Math.round(s/150),i=this.maxSecs/t,a=0;for(let t of[86400,3600,1800,60,30,10,5,1])if(i>=t){a=t;break}a||(a=.1),i=Math.floor(i/a)*a;let r=Math.ceil(this.tZero/i)*i;if(!i)return;let n=this._isUnix(),c=0;for(;;){let t=r-i*c,a=s-s*(this.tZero-t)/this.maxSecs;if(a<-75)break;c++,t=n?this.maxSecs<86400?new Date(1e3*t).toTimeString().split(" ")[0]:new Date(1e3*t).toISOString().split("T")[0]:(t/1e3).toFixed(1),e.config(this.$grid,{children:[p(0,l-o,s,l-o,this._getProp("--grid"),1.5),p(a,l-o-6,a,l-o-1,this._getProp("--grid"),2),d(t,a,l-o+14,this._getProp("--font"),11,{"text-anchor":"middle"})]})}}}_isUnix(){return Number(Object.keys(this.data)[0])}_getProp(t){return window.getComputedStyle(this.$svp).getPropertyValue(t)}_resetZ(){let t=Object.keys(this.data);this.tZero=(t.length?Number(t.slice(-1)[0]):l())/1e3}_clearMarkers(){t.clear(this.$cursor),t.clear(this.$markers),t.clear(this.$tooltip)}_disabled(t){return this.labels[t]&&this.labels[t].classList.contains("tint")}_getColv(){return this.cfg.dark?.55:.47}_getCol(t){return h(t,.6,this._getColv())}_fit(){let t=Object.keys(this.data).map(Number);t.length>2&&(this.maxSecs=(i(t)-t[0])/1e3)}_auto(t){this.auto!=t&&(this.auto=t,t?this.$auto.classList.add("active"):this.$auto.classList.remove("active"))}_setMax(t){this.maxSecs=t,this._render()}labels=[];units=[];dashed=[];points=null;tZero=0;maxSecs=10;auto=!1;static css=".svp.light{--back:#fff;--font:#111;--grid:#cacaca}.svp.dark{--back:#1c1d22;--font:#c3c3c3;--grid:#4a4a4a}.svp{all:unset;font-family:Verdana,sans-serif;background:var(--back);height:100%;width:100%;display:flex;flex-direction:column;color:var(--font);user-select:none;padding:4px;box-sizing:border-box;z-index:10}.svp.fullscreen{position:fixed;left:0;top:0}.svp .svcont{width:100%;height:100%;overflow:hidden;touch-action:none}.svp .menu{all:unset;flex-shrink:0;display:flex;justify-content:space-between;align-items:center;padding:5px 3px;min-height:24px}.svp .label{all:unset;display:inline-flex;vertical-align:middle;align-items:center;padding-right:7px;font-size:14px;cursor:pointer}.svp .label.tint{filter:opacity(.4)}.svp .label .marker{all:unset;width:7px;height:7px;margin-right:6px}.svp .buttons{all:unset;display:flex;align-items:stretch;gap:3px;flex-wrap:wrap}.svp .tblock.active{fill:var(--active);stroke:#000;stroke-width:3}.svp .button{all:unset;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid var(--grid);border-radius:7px;padding:2px;width:16px;height:16px;font-size:11px}.svp .button.active{border:1px solid var(--font)}.svp .button:hover{border:1px solid var(--font)}.svp .none{display:none}.svp .dots{all:unset;display:flex;align-items:center;justify-content:center;cursor:pointer;padding-left:7px;padding-right:2px}"}const h=(t,e,s)=>((t,e,s)=>{t%=360;let i=e*Math.min(s,1-s),l=(e,l=(e+t/30)%12)=>s-i*Math.max(Math.min(l-3,9-l,1),-1);return"rgb("+Math.round(255*l(0))+","+Math.round(255*l(8))+","+Math.round(255*l(4))+")"})(260*t+0,e,s),d=(t,s,i,l,a,r={},o=!1)=>e.text(t,s,i,{fill:l,...r},{style:`font-size: ${a}px;font-weight:${o?"bold":"unset"}`}),p=(t,s,i,l,a,r,o={})=>e.line(t,s,i,l,{stroke:a,fill:"none","stroke-width":r,...o}),f=t=>e.svg({viewBox:"0 0 24 24"},{style:"width:24px;height:24px",child:e.path(t,{fill:"none",stroke:"var(--font)","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"})});export{c as default};